<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>GameVinMon – Swap & Dice on Monad</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta
    name="description"
    content="GameVinMon dApp on Monad: Swap VIN ↔ MON at 1:1, play on-chain Dice with VIN, and see real-time VIN/USD price."
  />
  <meta name="theme-color" content="#020617" />

  <!-- Favicon -->
  <link rel="icon" type="image/png" href="logo128.png" />

  <!-- Main stylesheet -->
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="app-shell">
    <!-- Top Navigation -->
    <header class="top-nav">
      <div class="brand">
        <img src="logo128.png" alt="GameVinMon Logo" class="brand-logo" />
        <div class="brand-text">
          <div class="brand-title">GameVinMon</div>
          <div class="brand-subtitle">Swap • Dice • On Monad</div>
        </div>
      </div>

      <div class="nav-center">
        <nav class="nav-links">
          <button class="nav-link active" id="navHome">Home</button>
          <button class="nav-link" id="navSwap">Swap</button>
          <button class="nav-link" id="navDice">Dice</button>
        </nav>
      </div>

      <div class="nav-right">
        <div class="price-chip">
          <span class="price-label">1 VIN ≈</span>
          <span class="price-value" id="vinPriceUsd">Loading...</span>
          <span class="price-label">USD</span>
        </div>

        <div class="network-indicator">
          <span class="dot dot-disconnected" id="networkDot"></span>
          <span class="network-label" id="networkName">Not connected</span>
        </div>

        <button class="btn btn-connect" id="connectButton">
          Connect Wallet
        </button>
      </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
      <!-- HOME SCREEN -->
      <section class="screen screen-active" id="home-screen">
        <div class="hero-layout">
          <div class="hero-card">
            <div class="hero-main">
              <h1>GameVinMon on Monad</h1>
              <p class="hero-lead">
                Swap VIN ↔ MON at a fixed 1:1 rate and play fully on-chain Dice
                using VIN. Transparent, simple, and gas-efficient on Monad.
              </p>

              <div class="hero-actions">
                <button class="btn btn-primary" id="goToSwap">
                  Swap VIN / MON
                </button>
                <button class="btn btn-secondary" id="goToDice">
                  Play Dice
                </button>
              </div>

              <div class="hero-wallet">
                <div class="status-row">
                  <span class="status-label">Wallet:</span>
                  <span class="status-value" id="walletAddressShort">
                    Not connected
                  </span>
                </div>
                <div class="status-row">
                  <span class="status-label">VIN Balance:</span>
                  <span class="status-value" id="vinBalance">-</span>
                </div>
                <div class="status-row">
                  <span class="status-label">MON Balance:</span>
                  <span class="status-value" id="monBalance">-</span>
                </div>
                <div class="status-row">
                  <span class="status-label">Network:</span>
                  <span class="status-value" id="networkNameHome">
                    Not connected
                  </span>
                </div>
                <button class="btn btn-outline" id="refreshBalances">
                  Refresh Balances
                </button>
              </div>
            </div>

            <aside class="hero-side">
              <h2>How it works</h2>
              <ul class="info-list">
                <li>• VIN is an ERC20 token on Monad with fixed total supply.</li>
                <li>• Swap contract holds VIN/MON and enforces a 1:1 rate.</li>
                <li>• Dice contract holds VIN as a reward pool (bankroll).</li>
                <li>• All game outcomes are computed on-chain from block data.</li>
                <li>• If you win in Dice, you receive 2× your bet (minus gas).</li>
              </ul>
            </aside>
          </div>
        </div>
      </section>

      <!-- SWAP SCREEN -->
      <section class="screen" id="swap-screen">
        <div class="screen-header">
          <h1>Swap VIN ↔ MON</h1>
          <p class="screen-subtitle">
            Fixed 1:1 rate between VIN (ERC20) and MON (native) on Monad.
          </p>
        </div>

        <div class="swap-layout">
          <div class="swap-card">
            <div class="swap-header">
              <div class="swap-tabs">
                <button class="swap-tab active" id="tabVinToMon">
                  VIN → MON
                </button>
                <button class="swap-tab" id="tabMonToVin">
                  MON → VIN
                </button>
              </div>
            </div>

            <div class="swap-body">
              <div class="swap-row">
                <div class="swap-label-row">
                  <span class="swap-label">From</span>
                  <span class="swap-balance" id="fromBalanceLabel">
                    Balance: -
                  </span>
                </div>
                <div class="swap-input-row">
                  <input
                    type="text"
                    inputmode="decimal"
                    placeholder="0.0"
                    id="swapFromAmount"
                    class="swap-input"
                  />
                  <button class="swap-token-tag" id="swapFromToken">
                    VIN
                  </button>
                  <button class="btn-max" id="swapMaxButton">
                    MAX
                  </button>
                </div>
              </div>

              <div class="swap-row">
                <div class="swap-label-row">
                  <span class="swap-label">To</span>
                  <span class="swap-balance" id="toBalanceLabel">
                    Balance: -
                  </span>
                </div>
                <div class="swap-input-row">
                  <input
                    type="text"
                    placeholder="0.0"
                    id="swapToAmount"
                    class="swap-input"
                    readonly
                  />
                  <button class="swap-token-tag" id="swapToToken">
                    MON
                  </button>
                </div>
              </div>

              <div class="swap-rate">
                <span id="swapRateLabel">1 VIN = 1 MON</span>
              </div>

              <button class="btn btn-primary btn-swap-action" id="swapActionButton">
                Swap
              </button>

              <div class="tx-status" id="swapStatus">
                Ready to swap.
              </div>
            </div>
          </div>

          <aside class="swap-info-card">
            <h2>Swap Information</h2>
            <ul class="info-list">
              <li>• Smart contract: VinMonSwap (Monad).</li>
              <li>• Direction VIN → MON requires VIN approve to the swap contract.</li>
              <li>• Direction MON → VIN sends MON as native value in the transaction.</li>
              <li>• Rate is fixed at 1:1 and enforced by the contract.</li>
              <li>• All swaps are fully on-chain and verifiable.</li>
            </ul>
            <p class="info-note">
              Always double-check contract addresses before using the dApp.
            </p>
          </aside>
        </div>
      </section>

      <!-- DICE SCREEN -->
      <section class="screen" id="dice-screen">
        <div class="screen-header">
          <h1>Dice Game (VIN)</h1>
          <p class="screen-subtitle">
            Bet VIN on Even or Odd. The outcome is decided on-chain using block data.
            If you win, you get back 2× your bet (minus gas).
          </p>
        </div>

        <div class="dice-layout">
          <!-- Player & pool card -->
          <div class="dice-card dice-card-left">
            <div class="dice-section">
              <h2>Your Wallet</h2>
              <div class="status-row">
                <span class="status-label">Wallet:</span>
                <span class="status-value" id="diceWalletAddressShort">
                  Not connected
                </span>
              </div>
              <div class="status-row">
                <span class="status-label">VIN Balance:</span>
                <span class="status-value" id="diceVinBalance">
                  -
                </span>
              </div>
              <div class="status-row">
                <span class="status-label">MON Balance:</span>
                <span class="status-value" id="diceMonBalance">
                  -
                </span>
              </div>
            </div>

            <div class="dice-section">
              <h2>Reward Pool (VIN)</h2>
              <div class="status-row">
                <span class="status-label">Bankroll:</span>
                <span class="status-value" id="dicePoolVinTop">
                  Loading...
                </span>
              </div>
              <p class="dice-note">
                This is the VIN bankroll in the Dice contract used to pay winners.
              </p>
            </div>

            <div class="dice-section">
              <h2>Approval</h2>
              <p class="dice-note">
                Before playing, you must approve VIN for the Dice contract once.
                Approval amount can be large (for example 100,000 VIN) so you
                do not need to approve every bet.
              </p>
              <button class="btn btn-outline" id="diceApproveButton">
                Approve VIN for Dice
              </button>
              <div class="dice-min-info" id="diceMinInfo">
                Minimum bet: loading...
              </div>
            </div>
          </div>

          <!-- Play card -->
          <div class="dice-card dice-card-right">
            <div class="dice-section">
              <h2>Place Your Bet</h2>
              <label class="dice-label" for="diceBetAmount">Bet Amount (VIN)</label>
              <div class="dice-input-row">
                <input
                  type="text"
                  inputmode="decimal"
                  id="diceBetAmount"
                  class="dice-input"
                  placeholder="0.0"
                  value="0.01"
                />
                <button class="btn-max" id="diceMaxButton">MAX</button>
              </div>
              <div class="dice-minimum-line" id="diceMinimumText">
                Minimum bet: 0.0100 VIN
              </div>
            </div>

            <div class="dice-section">
              <h2>Choose your guess</h2>
              <div class="dice-guess-buttons">
                <button
                  class="btn-toggle guess-button active"
                  data-guess="even"
                  id="guessEvenButton"
                >
                  Even
                </button>
                <button
                  class="btn-toggle guess-button"
                  data-guess="odd"
                  id="guessOddButton"
                >
                  Odd
                </button>
              </div>
            </div>

            <div class="dice-section">
              <div class="dice-tools">
                <span class="dice-label">Quick tools</span>
                <div class="dice-tool-buttons">
                  <button class="btn-tool" id="diceRepeatButton">Repeat</button>
                  <button class="btn-tool" id="diceHalfButton">½</button>
                  <button class="btn-tool" id="diceDoubleButton">×2</button>
                  <button class="btn-tool" id="diceClearButton">Clear</button>
                </div>
              </div>
            </div>

            <!-- Visual -->
            <div class="dice-section">
              <div class="dice-visual" id="diceVisual">
                <div class="dice-orb"></div>
                <div class="dice-coins">
                  <span class="dice-coin dice-coin-white"></span>
                  <span class="dice-coin dice-coin-red"></span>
                  <span class="dice-coin dice-coin-white"></span>
                  <span class="dice-coin dice-coin-red"></span>
                </div>
              </div>
              <p class="dice-note">
                The 4 coins are just a visual effect. The real Even/Odd result
                is computed on-chain from block data.
              </p>
            </div>

            <div class="dice-section">
              <button class="btn btn-primary btn-full" id="dicePlayButton">
                Play Dice
              </button>
              <div class="tx-status" id="diceStatus">
                Place your bet and choose Even or Odd to start.
              </div>
            </div>

            <div class="dice-section dice-last-result">
              <h2>Last Result</h2>
              <div class="last-row">
                <span class="last-label">Last roll:</span>
                <span class="last-value" id="diceLastResult">-</span>
              </div>
              <div class="last-row">
                <span class="last-label">Outcome:</span>
                <span class="last-value" id="diceLastOutcome">-</span>
              </div>
              <div class="last-row">
                <span class="last-label">You:</span>
                <span class="last-value" id="diceLastWinLoss">-</span>
              </div>
              <div class="last-row">
                <span class="last-label">Payout:</span>
                <span class="last-value" id="diceLastPayout">-</span>
              </div>
              <div class="last-row">
                <span class="last-label">Tx Hash:</span>
                <span class="last-value" id="diceLastTx">-</span>
              </div>
              <button class="btn btn-outline" id="diceRefreshLast">
                Refresh Last Game
              </button>
            </div>

            <div class="dice-section">
              <h2>Reward Pool</h2>
              <p class="dice-note">
                Reward Pool: <span id="dicePoolVin">Loading...</span>
              </p>
              <p class="dice-note">
                All game results are on-chain. You can verify them through the
                Monad block explorer using your wallet address and transaction hashes.
              </p>
            </div>
          </div>
        </div>
      </section>
    </main>

    <!-- Footer -->
    <footer class="footer">
      <div class="footer-main">
        <span>© 2025 GameVinMon</span>
        <span class="footer-dot">•</span>
        <a
          href="https://monadvision.com/token/0x09166bFA4a40BAbC19CCCEc6A6154d9c058098EC"
          target="_blank"
          rel="noopener noreferrer"
        >
          VIN Token Contract
        </a>
        <span class="footer-dot">•</span>
        <a
          href="https://monadvision.com/address/0xCdce3485752E7a7D4323f899FEe152D9F27e890B"
          target="_blank"
          rel="noopener noreferrer"
        >
          Swap Contract
        </a>
        <span class="footer-dot">•</span>
        <a
          href="https://monadvision.com/address/0xE9Ed2c2987da0289233A1a1AE24438A314Ad6B2f"
          target="_blank"
          rel="noopener noreferrer"
        >
          Dice Contract
        </a>
      </div>
      <div class="footer-links">
        <a href="https://x.com/gamevinmon" target="_blank" rel="noopener noreferrer">
          Twitter
        </a>
        <span class="footer-dot">•</span>
        <a href="https://t.me/gamevinmon" target="_blank" rel="noopener noreferrer">
          Telegram
        </a>
        <span class="footer-dot">•</span>
        <a href="https://github.com/gamevin" target="_blank" rel="noopener noreferrer">
          GitHub
        </a>
      </div>
    </footer>
  </div>

  <!-- VIN price (via CoinGecko, from MON price) -->
  <script>
    async function fetchVinPriceUsd() {
      const label = document.getElementById("vinPriceUsd");
      if (!label) return;

      try {
        label.textContent = "Loading...";
        const res = await fetch(
          "https://api.coingecko.com/api/v3/simple/price?ids=monad&vs_currencies=usd"
        );
        if (!res.ok) {
          throw new Error("HTTP " + res.status);
        }
        const data = await res.json();
        const monPrice = data && data.monad && data.monad.usd;
        if (!monPrice) {
          label.textContent = "N/A";
          return;
        }
        // 1 VIN = 1 MON (1:1), so VIN price = MON price
        label.textContent = monPrice.toFixed(4);
      } catch (err) {
        console.error("Error fetching VIN price (via MON):", err);
        label.textContent = "N/A";
      }
    }

    fetchVinPriceUsd();
    setInterval(fetchVinPriceUsd, 60000);
  </script>

  <!-- Ethers.js (v5) and main dApp logic -->
  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
  <script src="app.js"></script>
</body>
</html>
